@model IEnumerable<DACS.Models.BenhNhan>
@{
    ViewData["Title"] = "IndexBenhNhan";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}


<h1>Quản lý bệnh nhân</h1>

<input type="text" id="searchInput" placeholder="Nhập số điện thoại...">
<table class="table">
    <thead>
        <tr>
            <th>Tên bệnh nhân</th>
            <th>Giới tính</th>
            <th>Ngày sinh</th>
            <th>Số điện thoại</th>
            <th>Địa chỉ</th>
            <th>Ảnh bệnh nhân</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>@item.Name</td>
                <td>@item.GioiTinh</td>
                <td>@item.NgaySinh.ToString("dd/MM/yyyy")</td>
                <td>@item.SoDienThoai</td>
                <td>@item.DiaChi</td>
                <td><img src="@item.ImageUrl" alt="Patient Image" class="patient-image" style="max-width: 80px; max-height: 100px;" /></td>
                <td>
                    <button class="view-image-btn" data-image-url="@item.ImageUrl">Xem ảnh</button>
                </td>
                <td> <a class="btn btn-danger" asp-action="DeleteBenhNhan" asp-route-id="@item.Id">Xóa</a> </td>
            </tr>
        }
    </tbody>
</table>
<div id="imageModal" class="modal">
    <span class="close">&times;</span>
    <img class="modal-content" id="modalImg">
    <div id="caption"></div>
</div>

<style>
    .modal {
        display: none;
        position: fixed;
        z-index: 9999;
        padding-top: 50px;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgb(0, 0, 0);
        background-color: rgba(0, 0, 0, 0.9);
    }

    .modal-content {
        margin: auto;
        display: block;
        width: 80%;
        max-width: 800px;
        max-height: 80%;
    }

    #caption {
        margin: auto;
        display: block;
        width: 80%;
        max-width: 800px;
        text-align: center;
        color: #ccc;
        padding: 10px 0;
        height: 150px;
    }

    .close {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        transition: 0.3s;
    }

        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
</style>
<script>
    document.getElementById("searchInput").addEventListener("keyup", function () {
        var searchText = this.value.toLowerCase();
        var rows = document.querySelectorAll("tbody tr");

        rows.forEach(function (row) {
            var phoneCell = row.cells[3].textContent.toLowerCase();
            if (phoneCell.includes(searchText)) {
                row.style.display = "";
            } else {
                row.style.display = "none";
            }
        });
    });
    var modal = document.getElementById("imageModal");
    var modalImg = document.getElementById("modalImg");
    var captionText = document.getElementById("caption");

    var btns = document.querySelectorAll('.view-image-btn');
    btns.forEach(btn => {
        btn.addEventListener('click', function () {
            modal.style.display = "block";
            modalImg.src = this.getAttribute('data-image-url');
            captionText.innerHTML = "Ảnh lớn";
        });
    });

    var span = document.getElementsByClassName("close")[0];
    span.onclick = function () {
        modal.style.display = "none";
    };
   
</script>